<!doctype html><html lang=en-us>
<head>
<link rel=preload href=/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous>
<link rel=preload href=/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<title> Bikes and Parking Places | dvoros.com</title>
<link rel=canonical href=https://dvoros.com/posts/bikes-and-parking-places/>
<meta name=description content="My name is Daniel. Here's where I write about stuff I'm tinkering with.">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=robots content="all,follow">
<meta name=googlebot content="index,follow,snippet,archive">
<meta property="og:title" content="Bikes and Parking Places">
<meta property="og:description" content="I&rsquo;m a huge fan of saving years of seemingly useless data and then trying to make sense of it. If I see a (sort-of) publicly available datasource that I can scrape and save I jump on it. It started with bike and moped sharing and later continued with &ldquo;smart parking&rdquo;.
In this post I&rsquo;m going to explain the process of finding, obtaining and archiving these datasets and will follow up with analysis later.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://dvoros.com/posts/bikes-and-parking-places/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-08-11T13:41:25+02:00">
<meta property="article:modified_time" content="2021-08-11T13:41:25+02:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Bikes and Parking Places">
<meta name=twitter:description content="I&rsquo;m a huge fan of saving years of seemingly useless data and then trying to make sense of it. If I see a (sort-of) publicly available datasource that I can scrape and save I jump on it. It started with bike and moped sharing and later continued with &ldquo;smart parking&rdquo;.
In this post I&rsquo;m going to explain the process of finding, obtaining and archiving these datasets and will follow up with analysis later.">
<link rel=stylesheet href=https://dvoros.com/css/styles.d45f37613b81ff47c14adf31bd1de1208b476cd4477b5cc5c671a567169f5206739c47be7e6ca6e99d5148dd0653466e9cc5ae428c04294e8dd3ac2604b300dd.css integrity="sha512-1F83YTuB/0fBSt8xvR3hIItHbNRHe1zFxnGlZxafUgZznEe+fmym6Z1RSN0GU0ZunMWuQowEKU6N06wmBLMA3Q=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]-->
<link rel=icon type=image/png href=https://dvoros.com/images/favicon.ico>
</head>
<body class="max-width mx-auto px3 ltr">
<div class="content index py4">
<div id=header-post>
<a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick="$('html, body').animate({scrollTop:0},'fast')" style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu>
<span id=nav>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writings</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</span>
<br>
<span id=actions>
<ul>
<li>
<a class=icon href=https://dvoros.com/about/ aria-label=Previous>
<i class="fas fa-chevron-left" aria-hidden=true onmouseover="$('#i-prev').toggle()" onmouseout="$('#i-prev').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up" aria-hidden=true onmouseover="$('#i-top').toggle()" onmouseout="$('#i-top').toggle()"></i>
</a>
</li>
<li>
<a class=icon href=# aria-label=Share>
<i class="fas fa-share-alt" aria-hidden=true onmouseover="$('#i-share').toggle()" onmouseout="$('#i-share').toggle()" onclick="return $('#share').toggle(),!1"></i>
</a>
</li>
</ul>
<span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span>
</span>
<br>
<div id=share style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f" aria-label=Facebook>
<i class="fab fa-facebook" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f&text=Bikes%20and%20Parking%20Places" aria-label=Twitter>
<i class="fab fa-twitter" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f&title=Bikes%20and%20Parking%20Places" aria-label=Linkedin>
<i class="fab fa-linkedin" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f&is_video=false&description=Bikes%20and%20Parking%20Places" aria-label=Pinterest>
<i class="fab fa-pinterest" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=Bikes%20and%20Parking%20Places&body=Check out this article: https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f" aria-label=Email>
<i class="fas fa-envelope" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f&title=Bikes%20and%20Parking%20Places" aria-label=Pocket>
<i class="fab fa-get-pocket" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f&title=Bikes%20and%20Parking%20Places" aria-label=reddit>
<i class="fab fa-reddit" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f&name=Bikes%20and%20Parking%20Places&description=I%26rsquo%3bm%20a%20huge%20fan%20of%20saving%20years%20of%20seemingly%20useless%20data%20and%20then%20trying%20to%20make%20sense%20of%20it.%20If%20I%20see%20a%20%28sort-of%29%20publicly%20available%20datasource%20that%20I%20can%20scrape%20and%20save%20I%20jump%20on%20it.%20It%20started%20with%20bike%20and%20moped%20sharing%20and%20later%20continued%20with%20%26ldquo%3bsmart%20parking%26rdquo%3b.%0aIn%20this%20post%20I%26rsquo%3bm%20going%20to%20explain%20the%20process%20of%20finding%2c%20obtaining%20and%20archiving%20these%20datasets%20and%20will%20follow%20up%20with%20analysis%20later." aria-label=Tumblr>
<i class="fab fa-tumblr" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f&t=Bikes%20and%20Parking%20Places" aria-label="Hacker News">
<i class="fab fa-hacker-news" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=toc>
<nav id=TableOfContents>
<ul>
<li><a href=#bikes-and-parking-places>Bikes and parking places</a></li>
<li><a href=#obtaining-the-data>Obtaining the data</a>
<ul>
<li><a href=#is-this-legal>Is this legal?</a></li>
</ul>
</li>
<li><a href=#what-to-save>What to save</a>
<ul>
<li><a href=#dummy-but-safe>Dummy but safe</a>
<ul>
<li><a href=#implementation>Implementation</a></li>
</ul>
</li>
<li><a href=#incremental-approach>Incremental approach</a>
<ul>
<li><a href=#implementation-1>Implementation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href=#archiving>Archiving</a></li>
<li><a href=#conclusion>Conclusion</a></li>
</ul>
</nav>
</div>
</span>
</div>
<article class=post itemscope itemtype=http://schema.org/BlogPosting>
<header>
<h1 class=posttitle itemprop="name headline">
Bikes and Parking Places
</h1>
<div class=meta>
<div class=postdate>
<time datetime="2021-08-11 13:41:25 +0200 +0200" itemprop=datePublished>2021-08-11</time>
</div>
<div class=article-read-time>
<i class="far fa-clock"></i>
6 minute read
</div>
<div class=article-category>
<i class="fas fa-archive"></i>
<a class=category-link href=/categories/notes>notes</a>
</div>
<div class=article-tag>
<i class="fas fa-tag"></i>
<a class=tag-link href=/tags/backup rel=tag>backup</a>
</div>
</div>
</header>
<div class=content itemprop=articleBody>
<p>I&rsquo;m a huge fan of saving years of seemingly useless data and then trying to make
sense of it. If I see a (sort-of) publicly available datasource that I can
scrape and save I jump on it. It started with bike and moped sharing and
later continued with &ldquo;smart parking&rdquo;.</p>
<p>In this post I&rsquo;m going to explain the process of finding, obtaining and archiving
these datasets and will follow up with analysis later.</p>
<h2 id=bikes-and-parking-places>Bikes and parking places</h2>
<p>It all started with
<a href=https://en.wikipedia.org/wiki/BuBi>Bubi</a>,
a public bike sharing network in Budapest. Then it continued with the moped
sharing
<a href=https://blinkee.city/en>blinkee</a>
application and later with
<a href=https://smartlynx.hu/en/home/>smart parking</a>.</p>
<p>What these all have in common is that they have some app or website where
you can check their current state (bike locations, free parking spots, etc.).
If there&rsquo;s an app, there&rsquo;s a datasource behind it and it turns out these are
sort-of publicly available.</p>
<h2 id=obtaining-the-data>Obtaining the data</h2>
<p>As far as I can tell none of these services publicly advertise their APIs.
However they also don&rsquo;t seem to be actively trying to block &ldquo;outside&rdquo; access
to them. This means that getting the data boils down to finding the URL you need
to download.</p>
<p>For some services this is as simple as opening their website in a browser and
checking the outgoing requests:</p>
<div style=text-align:center>
<img src=https://dvoros.com/images/url-from-browser.png style=max-width:80% alt data-zoomable>
</div>
<p>For others, when there&rsquo;s no web access &ndash; only a mobile app &ndash; you might have to
set up a
<a href=https://en.wikipedia.org/wiki/Man-in-the-middle_attack>MITM</a>
proxy that routes all traffic through your computer where you&rsquo;re able to sniff
it. If they use HTTPS (which they should and usually do) then you need to
<a href=https://httptoolkit.tech/blog/intercepting-android-https/>jump some extra hoops</a>
to get your own certificate accepted by your phone.</p>
<h3 id=is-this-legal>Is this legal?</h3>
<p>Short answer: I have no idea. However, I don&rsquo;t think that this should be a real
concern for any of the services. My rule of thumb was to keep the load I&rsquo;m
generating similar to a &ldquo;legitimate&rdquo; user&rsquo;s. E.g. if the website only refreshes
the data every minute, I&rsquo;m also only getting it once a minute.</p>
<p>To indicate that I mean no harm and make their life easier if they ever decide
to block my requests I&rsquo;m also including the following constant HTTP header in
all my requests (with a different value):</p>
<pre><code>x-block-me-if-you-want: taimocbknbzxntsyklkobvcw
</code></pre><p>Also, my requests always come from the same IP address.</p>
<h2 id=what-to-save>What to save</h2>
<p>So I have an HTTP API endpoint that gives me an JSON/XML response with the <em>whole
state</em> of the service every time I call it. What exactly should I save?</p>
<h3 id=dummy-but-safe>Dummy but safe</h3>
<p>Trivial answer would be to save the whole
response every time and this is what I started with.</p>
<p>I think this is generally
a good approach. If you&rsquo;re going to process your data later and don&rsquo;t know
exactly what you&rsquo;re interested in at the time of saving, it can&rsquo;t hurt to save
<em>everything</em> (assuming that paying for storing tens of gigabytes of data
doesn&rsquo;t hurt).</p>
<h4 id=implementation>Implementation</h4>
<p>This approach is really this simple:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span style=color:#8be9fd;font-style:italic>DT</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>`</span><span style=color:#8be9fd;font-style:italic>TZ</span><span style=color:#ff79c6>=</span>Europe/Budapest date <span style=color:#f1fa8c>&#34;+%F-%H-%M-%S&#34;</span><span style=color:#f1fa8c>`</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span style=color:#8be9fd;font-style:italic>y</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>`</span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#8be9fd;font-style:italic>$DT</span> | cut -b 1-4<span style=color:#f1fa8c>`</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span style=color:#8be9fd;font-style:italic>m</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>`</span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#8be9fd;font-style:italic>$DT</span> | cut -b 6-7<span style=color:#f1fa8c>`</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span style=color:#8be9fd;font-style:italic>d</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>`</span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#8be9fd;font-style:italic>$DT</span> | cut -b 9-10<span style=color:#f1fa8c>`</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span style=color:#8be9fd;font-style:italic>dir</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;</span><span style=color:#8be9fd;font-style:italic>$y</span><span style=color:#f1fa8c>/</span><span style=color:#8be9fd;font-style:italic>$y</span><span style=color:#f1fa8c>-</span><span style=color:#8be9fd;font-style:italic>$m</span><span style=color:#f1fa8c>/</span><span style=color:#8be9fd;font-style:italic>$y</span><span style=color:#f1fa8c>-</span><span style=color:#8be9fd;font-style:italic>$m</span><span style=color:#f1fa8c>-</span><span style=color:#8be9fd;font-style:italic>$d</span><span style=color:#f1fa8c>&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span>mkdir -p /path/to/save/data/<span style=color:#8be9fd;font-style:italic>$dir</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span>wget -qO- --header<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#39;x-block-me-if-you-want: ...&#39;</span> <span style=color:#f1fa8c>&#39;https://example.com/some-api&#39;</span> | gzip &gt; /path/to/save/data/<span style=color:#8be9fd;font-style:italic>$dir</span>/<span style=color:#8be9fd;font-style:italic>$DT</span>.xml.gz
</code></pre></div><p>Making these year/month/day subdirectories not only helps organize your data
but also to overcome filesystem (and blobstore) limitations around number of
files in the same directory (or bucket). It also makes archiving easier. More on
that a little later.</p>
<h3 id=incremental-approach>Incremental approach</h3>
<p>The problem with saving everything is that you can end up with <em>a lot</em> of data
quite quickly. A single response from the smart parking API is around 800kB.
Save that every 5 seconds for a day and you will end up with:</p>
<blockquote>
<p><code>800kB * (60 * 60 * 24 / 5) = 13.824gB</code></p>
</blockquote>
<p>Gzipping would help but it&rsquo;s still more than I&rsquo;d like to store for such
(seemingly) useless data.</p>
<p>If you scrape an API every five seconds, you&rsquo;ll notice that not much changes
in that time. The smart parking datasource shows 3-5 changes per 5 seconds in
peak hours. It would be enough to only save the changed parts and the whole
state could be recovered at any moment in the past. This is the idea behind
<a href=https://en.wikipedia.org/wiki/Incremental_backup>incremental backups</a>.</p>
<p>But what classifies as a &ldquo;change&rdquo; and what is a &ldquo;changed part&rdquo;?</p>
<p>Every datasource I&rsquo;m crawling contains some kind of list. List of bike racks or
list of parking places. Changed part means an item in this list, so a single
bike rack or a parking place. Change means <em>any</em> kind of change to an existing
item or the appearance of a new item (e.g. when a new parking place is
installed).</p>
<p>For an average day, this results in storing around 70mB instead of 13gB which
is a huge improvement. Gzip that and it&rsquo;s only around <strong>1mB per day</strong>.</p>
<h4 id=implementation-1>Implementation</h4>
<p>Obviously this approach requires understanding your data to some extent (where
is the list I&rsquo;m interested in) and some logic that differentiates between states.
I&rsquo;m running a little service written in Go that scrapes the APIs and does the
incremental backup in the same <code>year/month/day</code> directory structure as the
dummy approach.</p>
<p>Some details:</p>
<ul>
<li>Prepare for failure: If the application dies (e.g. if I were to forget
handling network failures gracefully), a new instance should be
able to pick up where the old left off. This would require reading all the
previous increments to re-construct the current state. To avoid having to
do this (would be very slow and I also don&rsquo;t want to keep every previous
increment in the local file sytem) I&rsquo;ve ended up always saving the full
current state into a &ldquo;backup&rdquo; file.
This is also useful when upgrading the application to a newer version.</li>
<li>Preprocessing: some metrics are easy to generate when detecting a change and
it makes sense to store them with the data. E.g. storing the previous state and
the time it has last changed.</li>
<li>Live data: The application is also publishing events (changes) in real time
on a WebSocket endpoint.</li>
<li>Live analysis: I&rsquo;ve ended up loading the data into Elasticsearch later on.
Then I&rsquo;ve extended the application with loading the events into Elastic in
real time.</li>
</ul>
<h2 id=archiving>Archiving</h2>
<p>Both approaches outlined above will leave me with data as files in the local
file system in the following directory structure:</p>
<pre><code>├── data
│   ├── 2021
│   |   ├── 2021-08
│   |   |   ├── 2021-08-10
│   |   |   |   ├── 2021-08-10-00-00-04-+02.json
│   |   |   |   ├── 2021-08-10-00-00-09-+02.json
│   |   |   |   ├── ...
│   |   |   ├── 2021-08-11
│   |   |   |   ├── 2021-08-11-00-00-04-+02.json
│   |   |   |   ├── 2021-08-11-00-00-09-+02.json
│   |   |   |   ├── ...
│   |   |   └── ...
│   |   ├── ...
</code></pre><p>Local store would fill up quickly if I kept adding files this way. So instead of
keeping everything locally, I&rsquo;m archiving data in daily chunks to Scaleway&rsquo;s
<a href=https://www.scaleway.com/en/object-storage/>Object Storage</a> (an S3-compatible
blobstore) where storage capacity is (seemingly) infinite if you&rsquo;re willing
to pay the price. First 75gB is free though.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span style=color:#ff79c6>#!/bin/bash
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span style=color:#ff79c6></span><span style=color:#6272a4>#</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span style=color:#6272a4># This script aggregates yesterday&#39;s parker data and uploads that</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span style=color:#6272a4># to Object Storage. Invoked from cron every morning.</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span style=color:#8be9fd;font-style:italic>cd</span> /mnt/data
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span style=color:#8be9fd;font-style:italic>TMPDIR</span><span style=color:#ff79c6>=</span>/tmp/parker-upload
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span>mkdir -p <span style=color:#8be9fd;font-style:italic>$TMPDIR</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span style=color:#6272a4># Get yesterday&#39;s directory</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span style=color:#8be9fd;font-style:italic>DT</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>`</span><span style=color:#8be9fd;font-style:italic>TZ</span><span style=color:#ff79c6>=</span>Europe/Budapest date --date<span style=color:#ff79c6>=</span>yesterday <span style=color:#f1fa8c>&#34;+%F&#34;</span><span style=color:#f1fa8c>`</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span style=color:#8be9fd;font-style:italic>y</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>`</span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#8be9fd;font-style:italic>$DT</span> | cut -b 1-4<span style=color:#f1fa8c>`</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span style=color:#8be9fd;font-style:italic>m</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>`</span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#8be9fd;font-style:italic>$DT</span> | cut -b 6-7<span style=color:#f1fa8c>`</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span style=color:#8be9fd;font-style:italic>d</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>`</span><span style=color:#8be9fd;font-style:italic>echo</span> <span style=color:#8be9fd;font-style:italic>$DT</span> | cut -b 9-10<span style=color:#f1fa8c>`</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span style=color:#8be9fd;font-style:italic>dir</span><span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;parker/data/</span><span style=color:#8be9fd;font-style:italic>$y</span><span style=color:#f1fa8c>/</span><span style=color:#8be9fd;font-style:italic>$y</span><span style=color:#f1fa8c>-</span><span style=color:#8be9fd;font-style:italic>$m</span><span style=color:#f1fa8c>/</span><span style=color:#8be9fd;font-style:italic>$y</span><span style=color:#f1fa8c>-</span><span style=color:#8be9fd;font-style:italic>$m</span><span style=color:#f1fa8c>-</span><span style=color:#8be9fd;font-style:italic>$d</span><span style=color:#f1fa8c>&#34;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span style=color:#6272a4># Compress into a tar.gz</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span style=color:#8be9fd;font-style:italic>DAILY_NAME</span><span style=color:#ff79c6>=</span><span style=color:#8be9fd;font-style:italic>$TMPDIR</span>/<span style=color:#8be9fd;font-style:italic>$DT</span>.tar.gz
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span>tar -czf <span style=color:#8be9fd;font-style:italic>$DAILY_NAME</span> <span style=color:#8be9fd;font-style:italic>$dir</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span style=color:#6272a4># Upload to Object Storage</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span style=color:#8be9fd;font-style:italic>UPLOAD_PATH</span><span style=color:#ff79c6>=</span><span style=color:#8be9fd;font-style:italic>$dir</span>.tar.gz
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span>aws s3 cp <span style=color:#8be9fd;font-style:italic>$DAILY_NAME</span> s3://<span style=color:#8be9fd;font-style:italic>$UPLOAD_PATH</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span style=color:#6272a4># Remove from local FS</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span>rm <span style=color:#8be9fd;font-style:italic>$DAILY_NAME</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span>rm -r <span style=color:#8be9fd;font-style:italic>$dir</span>
</code></pre></div><h2 id=conclusion>Conclusion</h2>
<p>This has covered how I&rsquo;ve ended up with gigabytes of seemingly useless data. In
the next post I&rsquo;ll describe the datasets in a little more detail and will try
to find interesting patterns in there.</p>
</div>
</article>
<div class=blog-post-comments>
<script data-isso=//comments.dvoros.com/ data-isso-reply-to-self=false data-isso-require-author=true data-isso-require-email=true src=//comments.dvoros.com/js/embed.min.js></script>
<section id=isso-thread></section>
</div>
<div id=footer-post-container>
<div id=footer-post>
<div id=nav-footer style=display:none>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writings</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</div>
<div id=toc-footer style=display:none>
<nav id=TableOfContents>
<ul>
<li><a href=#bikes-and-parking-places>Bikes and parking places</a></li>
<li><a href=#obtaining-the-data>Obtaining the data</a>
<ul>
<li><a href=#is-this-legal>Is this legal?</a></li>
</ul>
</li>
<li><a href=#what-to-save>What to save</a>
<ul>
<li><a href=#dummy-but-safe>Dummy but safe</a>
<ul>
<li><a href=#implementation>Implementation</a></li>
</ul>
</li>
<li><a href=#incremental-approach>Incremental approach</a>
<ul>
<li><a href=#implementation-1>Implementation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href=#archiving>Archiving</a></li>
<li><a href=#conclusion>Conclusion</a></li>
</ul>
</nav>
</div>
<div id=share-footer style=display:none>
<ul>
<li>
<a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f" aria-label=Facebook>
<i class="fab fa-facebook fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://twitter.com/share?url=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f&text=Bikes%20and%20Parking%20Places" aria-label=Twitter>
<i class="fab fa-twitter fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f&title=Bikes%20and%20Parking%20Places" aria-label=Linkedin>
<i class="fab fa-linkedin fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f&is_video=false&description=Bikes%20and%20Parking%20Places" aria-label=Pinterest>
<i class="fab fa-pinterest fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="mailto:?subject=Bikes%20and%20Parking%20Places&body=Check out this article: https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f" aria-label=Email>
<i class="fas fa-envelope fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f&title=Bikes%20and%20Parking%20Places" aria-label=Pocket>
<i class="fab fa-get-pocket fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f&title=Bikes%20and%20Parking%20Places" aria-label=reddit>
<i class="fab fa-reddit fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f&name=Bikes%20and%20Parking%20Places&description=I%26rsquo%3bm%20a%20huge%20fan%20of%20saving%20years%20of%20seemingly%20useless%20data%20and%20then%20trying%20to%20make%20sense%20of%20it.%20If%20I%20see%20a%20%28sort-of%29%20publicly%20available%20datasource%20that%20I%20can%20scrape%20and%20save%20I%20jump%20on%20it.%20It%20started%20with%20bike%20and%20moped%20sharing%20and%20later%20continued%20with%20%26ldquo%3bsmart%20parking%26rdquo%3b.%0aIn%20this%20post%20I%26rsquo%3bm%20going%20to%20explain%20the%20process%20of%20finding%2c%20obtaining%20and%20archiving%20these%20datasets%20and%20will%20follow%20up%20with%20analysis%20later." aria-label=Tumblr>
<i class="fab fa-tumblr fa-lg" aria-hidden=true></i>
</a>
</li>
<li>
<a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fdvoros.com%2fposts%2fbikes-and-parking-places%2f&t=Bikes%20and%20Parking%20Places" aria-label="Hacker News">
<i class="fab fa-hacker-news fa-lg" aria-hidden=true></i>
</a>
</li>
</ul>
</div>
<div id=actions-footer>
<a id=menu-toggle class=icon href=# onclick="return $('#nav-footer').toggle(),!1" aria-label=Menu>
<i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick="return $('#toc-footer').toggle(),!1" aria-label=TOC>
<i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick="return $('#share-footer').toggle(),!1" aria-label=Share>
<i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick="$('html, body').animate({scrollTop:0},'fast')" aria-label="Top of Page">
<i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a>
</div>
</div>
</div>
<footer id=footer>
<div class=footer-left>
Copyright &copy; 2021
Daniel Voros
</div>
<div class=footer-right>
<nav>
<ul>
<li><a href=/>Home</a></li>
<li><a href=/posts>Writings</a></li>
<li><a href=/tags>Tags</a></li>
<li><a href=/about>About</a></li>
</ul>
</nav>
</div>
</footer>
<script src=//unpkg.com/medium-zoom@1.0.6/dist/medium-zoom.min.js></script>
<script>mediumZoom('[data-zoomable]')</script>
<script type=text/javascript>var _paq=window._paq=window._paq||[];_paq.push(['disableCookies']),_paq.push(['trackPageView']),_paq.push(['enableLinkTracking']),function(){var b="//matomo.dvoros.com/",c,a,d;_paq.push(['setTrackerUrl',b+'matomo.php']),_paq.push(['setSiteId','2']),c=document,a=c.createElement('script'),d=c.getElementsByTagName('script')[0],a.type='text/javascript',a.async=!0,a.src=b+'matomo.js',d.parentNode.insertBefore(a,d)}()</script>
</div>
</body>
<link rel=stylesheet href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>
<script src=/js/code-copy.js></script>
</html>